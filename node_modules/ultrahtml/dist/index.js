var L=0,R=1,k=2,j=3,X=4;function V(e,n={},...a){let r={type:1,name:typeof e=="function"?e.name:e,attributes:n||{},children:a.map(t=>typeof t=="string"?{type:2,value:y(String(t))}:t),parent:void 0,loc:[]};return typeof e=="function"&&C(r,e),r}var b=Symbol("Fragment"),D=new Set(["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),x=new Set(["script","style"]),_=/([\@\.a-z0-9_\:\-]*)\s*?=?\s*?(['"]?)([\s\S]*?)\2\s+/gim,s=/(?:<(\/?)([a-zA-Z][a-zA-Z0-9\:-]*)(?:\s([^>]*?))?((?:\s*\/)?)>|(<\!\-\-)([\s\S]*?)(\-\->)|(<\!)([\s\S]*?)(>))/gm;function P(e){let n={},a;if(e)for(_.lastIndex=0,e=" "+(e||"")+" ";a=_.exec(e);)a[0]!==" "&&(n[a[1]]=a[3]);return n}function w(e){let n=typeof e=="string"?e:e.value,a,r,t,o,l,d,g,h,i,c=[];s.lastIndex=0,r=a={type:0,children:[]};let E=0;function m(){o=n.substring(E,s.lastIndex-t[0].length),o&&r.children.push({type:2,value:o,parent:r})}for(;t=s.exec(n);){if(d=t[5]||t[8],g=t[6]||t[9],h=t[7]||t[10],x.has(r.name)&&t[2]!==r.name){l=s.lastIndex-t[0].length,r.children.length>0&&(r.children[0].value+=t[0]);continue}else if(d==="<!--"){if(l=s.lastIndex-t[0].length,x.has(r.name))continue;i={type:3,value:g,parent:r,loc:[{start:l,end:l+d.length},{start:s.lastIndex-h.length,end:s.lastIndex}]},c.push(i),i.parent.children.push(i)}else if(d==="<!")l=s.lastIndex-t[0].length,i={type:4,value:g,parent:r,loc:[{start:l,end:l+d.length},{start:s.lastIndex-h.length,end:s.lastIndex}]},c.push(i),i.parent.children.push(i);else if(t[1]!=="/")if(m(),x.has(r.name)){E=s.lastIndex,m();continue}else i={type:1,name:t[2]+"",attributes:P(t[3]),parent:r,children:[],loc:[{start:s.lastIndex-t[0].length,end:s.lastIndex}]},c.push(i),i.parent.children.push(i),t[4]&&t[4].indexOf("/")>-1||D.has(i.name)?(i.loc[1]=i.loc[0],i.isSelfClosingTag=!0):r=i;else m(),t[2]+""===r.name?(i=r,r=i.parent,i.loc.push({start:s.lastIndex-t[0].length,end:s.lastIndex}),o=n.substring(i.loc[0].end,i.loc[1].start),i.children.length===0&&i.children.push({type:2,value:o,parent:r})):t[2]+""===c[c.length-1].name&&c[c.length-1].isSelfClosingTag===!0&&(i=c[c.length-1],i.loc.push({start:s.lastIndex-t[0].length,end:s.lastIndex}));E=s.lastIndex}return o=n.slice(E),r.children.push({type:2,value:o,parent:r}),a}var T=class{constructor(n){this.callback=n}async visit(n,a,r){if(await this.callback(n,a,r),Array.isArray(n.children)){let t=[];for(let o=0;o<n.children.length;o++){let l=n.children[o];t.push(this.visit(l,n,o))}await Promise.all(t)}}},O=class{constructor(n){this.callback=n}visit(n,a,r){if(this.callback(n,a,r),Array.isArray(n.children))for(let t=0;t<n.children.length;t++){let o=n.children[t];this.visit(o,n,t)}}},N=Symbol("HTMLString"),S=Symbol("AttrString"),u=Symbol("RenderFn");function f(e,n=[N]){let a={value:e};for(let r of n)Object.defineProperty(a,r,{value:!0,enumerable:!1,writable:!1});return a}function U(e){return f(e)}function C(e,n){return Object.defineProperty(e,u,{value:n,enumerable:!1}),e}var I={"&":"&amp;","<":"&lt;",">":"&gt;"};function y(e){return e.replace(/[&<>]/g,n=>I[n]||n)}function p(e){let n="";for(let[a,r]of Object.entries(e))n+=` ${a}="${r}"`;return f(n,[N,S])}function Y(e,...n){let a="";for(let r=0;r<e.length;r++){a+=e[r];let t=n[r];a.endsWith("...")&&t&&typeof t=="object"?(a=a.slice(0,-3).trimEnd(),a+=p(t).value):t&&t[S]?(a=a.trimEnd(),a+=t.value):t&&t[N]?a+=t.value:typeof t=="string"?a+=y(t):(t||t===0)&&(a+=String(t))}return f(a)}function F(e,n){return new T(n).visit(e)}function H(e,n){return new O(n).visit(e)}async function $(e){let{name:n,attributes:a={}}=e,r=await Promise.all(e.children.map(t=>v(t))).then(t=>t.join(""));if(u in e){let t=await e[u](a,f(r));return t&&t[N]?t.value:y(String(t))}return n===b?r:D.has(n)?`<${e.name}${p(a).value}>`:`<${e.name}${p(a).value}>${r}</${e.name}>`}function A(e){let{name:n,attributes:a={}}=e,r=e.children.map(t=>M(t)).join("");if(u in e){let t=e[u](a,f(r));return t&&t[N]?t.value:y(String(t))}return n===b?r:D.has(n)?`<${e.name}${p(a).value}>`:`<${e.name}${p(a).value}>${r}</${e.name}>`}function M(e){switch(e.type){case 0:return e.children.map(n=>M(n)).join("");case 1:return A(e);case 2:return`${e.value}`;case 3:return`<!--${e.value}-->`;case 4:return`<!${e.value}>`}}async function v(e){switch(e.type){case 0:return Promise.all(e.children.map(n=>v(n))).then(n=>n.join(""));case 1:return $(e);case 2:return`${e.value}`;case 3:return`<!--${e.value}-->`;case 4:return`<!${e.value}>`}}async function z(e,n=[]){if(!Array.isArray(n))throw new Error(`Invalid second argument for \`transform\`! Expected \`Transformer[]\` but got \`${typeof n}\``);let r=typeof e=="string"?w(e):e;for(let t of n)r=await t(r);return v(r)}export{j as COMMENT_NODE,X as DOCTYPE_NODE,L as DOCUMENT_NODE,R as ELEMENT_NODE,b as Fragment,u as RenderFn,k as TEXT_NODE,U as __unsafeHTML,C as __unsafeRenderFn,p as attrs,V as h,Y as html,w as parse,v as render,M as renderSync,z as transform,F as walk,H as walkSync};
